USE [ParksGIS]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



CREATE VIEW [DPR].[vw_GISAllSites]
AS
SELECT        SYSTEM, GISPROPNUM, OMPPROPID AS PropID, SITENAME AS Name, LOCATION, 'Greenstreet' AS SourceTable, ACRES AS GISACRES, 
                         DEPARTMENT AS AMPSDistrict, COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZIPCODE AS Zip, RETIRED AS GIS_Retired, COMMISSIONDATE, 
                         SUBCATEGORY, PARENTID AS PermitDistrict, NULL AS TYPECATEGORY, 'DOT' AS JURISDICTION, NYS_ASSEMBLY AS NYSAssembly, NYS_SENATE AS NYSSenate,
                          US_CONGRESS AS USCongress, Precinct
FROM            DPR.GREENSTREET_EVW
WHERE          SYSTEM <>'X128-XZ475'
UNION
SELECT        GISPROPNUM AS SYSTEM, GISPROPNUM, OMPPROPID AS PropID, SIGNNAME, LOCATION, 'Property' AS SourceTable, ACRES AS GISACRES, 
                         DEPARTMENT AS AMPSDistrict, COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZIPCODE AS Zip, RETIRED, COMMISSIONDATE, NULL AS SUBCATEGORY, 
                         PARENTID AS PermitDistrict, TYPECATEGORY, JURISDICTION, NYS_ASSEMBLY AS NYSAssembly, NYS_SENATE AS NYSSenate, US_CONGRESS AS USCongress, 
                         Precinct
FROM            DPR.PROPERTY_EVW
WHERE        OMPPROPID <> ''
UNION
SELECT        SYSTEM, PARENTID AS GISPROPNUM, OMPPROPID AS PropID, SITENAME AS Name, LOCATION, 'Zone' AS SourceTable, ACRES AS GISACRES, 
                         DEPARTMENT AS AMPSDistrict, COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZIPCODE AS Zip, RETIRED, COMMISSIONDATE, NULL AS SUBCATEGORY, 
                         PARENTID AS PermitDistrict, NULL AS TYPECATEGORY, 'DPR' AS JURISDICTION, NYS_ASSEMBLY AS NYSAssembly, NYS_SENATE AS NYSSenate, 
                         US_CONGRESS AS USCongress, Precinct
FROM            DPR.ZONE_EVW
UNION
SELECT        SYSTEM, GISPROPNUM, OMPPROPID AS PropID, SIGNNAME, LOCATION, 'Playground' AS SourceTable, ACRES AS GISACRES, DEPARTMENT AS AMPSDistrict, 
                         COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZIPCODE AS Zip, RETIRED, COMMISSIONDATE, NULL AS SUBCATEGORY, PARENTID AS PermitDistrict, NULL 
                         AS TYPECATEGORY, 'DPR' AS JURISDICTION, NYS_ASSEMBLY AS NYSAssembly, NYS_SENATE AS NYSSenate, US_CONGRESS AS USCongress, Precinct
FROM            DPR.PLAYGROUND_EVW
UNION
SELECT        GISPROPNUM AS SYSTEM, GISPROPNUM, OMPPROPID AS PropID, SIGNNAME AS Name, LOCATION, 'Schoolyard' AS SourceTable, ACRES AS GISACRES, 
                         DEPARTMENT AS AMPSDistrict, COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZIPCODE AS Zip, RETIRED, '' COMMISSIONDATE, NULL AS SUBCATEGORY, 
                         PARENTID AS PermitDistrict, NULL AS TYPECATEGORY, 'DOE' AS JURISDICTION, NYS_ASSEMBLY AS NYSAssembly, NYS_SENATE AS NYSSenate, 
                         US_CONGRESS AS USCongress, Precinct
FROM            DPR.SCHOOLYARD_TO_PLAYGROUND_EVW
UNION
SELECT        SYSTEM, GISPROPNUM, OMPPROPID AS PropID, NAME AS Name, LOCATION, 'Golfcourse' AS SourceTable, ACRES AS GISACRES, DEPARTMENT AS AMPSDistrict, 
                         COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZIPCODE AS Zip, RETIRED, COMMISSIONDATE, NULL AS SUBCATEGORY, PARENTID AS PermitDistrict, NULL 
                         AS TYPECATEGORY, 'DPR' AS JURISDICTION, NYS_ASSEMBLY AS NYSAssembly, NYS_SENATE AS NYSSenate, US_CONGRESS AS USCongress, Precinct
FROM            DPR.GOLFCOURSE_EVW
UNION
SELECT        SYSTEM, GISPROPNUM, OMPPROPID AS PropID, NAME AS Name, LOCATION, 'Structure' AS SourceTable, NULL AS GISACRES, DEPARTMENT AS AMPSDistrict, 
                         COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZIPCODE AS Zip, RETIRED, COMMISSIONDATE, NULL AS SUBCATEGORY, PARENTID AS PermitDistrict, NULL 
                         AS TYPECATEGORY, 'DPR' AS JURISDICTION, NYS_ASSEMBLY AS NYSAssembly, NYS_SENATE AS NYSSenate, US_CONGRESS AS USCongress, Precinct
FROM            DPR.STRUCTURE_EVW
WHERE        PIP_RATABLE = 'Yes'
UNION
SELECT        SYSTEM, GISPROPNUM, OMPPROPID AS PropID, NAME AS Name, LOCATION, 'Unmapped' AS SourceTable, NULL AS GISACRES, DEPARTMENT AS AMPSDistrict, 
                         COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZipCode AS Zip, RETIRED, NULL AS COMMISSIONDATE, NULL AS SUBCATEGORY, NULL 
                         AS PermitDistrict, NULL AS TYPECATEGORY, 'DPR' AS JURISDICTION, NULL AS NYSAssembly, NULL AS NYSSenate, NULL AS USCongress, NULL AS Precinct
FROM            DPR.UNMAPPED_GISALLSITES_EVW
UNION
SELECT        GISPROPNUM AS SYSTEM, GISPROPNUM, OMPPROPID AS PropID, SIGNNAME AS Name, LOCATION, 'RestrictiveDec' AS SourceTable, ACRES AS GISACRES, 
                         DEPARTMENT AS AMPSDistrict, COUNCILDISTRICT, COMMUNITYBOARD, BOROUGH, ZipCode AS Zip, RETIRED, COMMISSIONDATE, NULL AS SUBCATEGORY, 
                         PARENTID AS PermitDistrict, NULL AS TYPECATEGORY, 'Private' AS JURISDICTION, NYS_ASSEMBLY AS NYSAssembly, NYS_SENATE AS NYSSenate, 
                         US_CONGRESS AS USCongress, Precinct
FROM            DPR.RESTRICTIVEDECLARATIONSITE_EVW
WHERE GISPROPNUM <> 'M404'
GO

